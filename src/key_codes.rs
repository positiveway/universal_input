use color_eyre::eyre::bail;
use color_eyre::{Report, Result};
use serde::{Deserialize, Serialize};
use strum_macros::{AsRefStr, Display, EnumIter, EnumString};

#[cfg(target_os = "linux")]
use mouse_keyboard_input::{key_codes};

#[cfg(all(target_os = "linux", not(feature = "enigo-always"), not(feature = "use-tfc")))]
use mouse_keyboard_input::{Button};

#[cfg(all(target_os = "linux", feature = "use-tfc"))]
use tfc::{Key};

#[cfg(any(target_os = "windows", all(target_os = "linux", feature = "enigo-always")))]
use enigo::{Keyboard, Key};

pub type KeyCodes = Vec<KeyCode>;

#[derive(PartialOrd, EnumIter, EnumString, AsRefStr, Display, Eq, Hash, PartialEq, Copy, Clone, Debug, Serialize, Deserialize, )]
pub enum KeyCode {
    None,
    RESET_BTN,
    SWITCH_MODE_BTN,
    RELEASE_ALL,
    KEY_ESC,
    KEY_1,
    KEY_2,
    KEY_3,
    KEY_4,
    KEY_5,
    KEY_6,
    KEY_7,
    KEY_8,
    KEY_9,
    KEY_10,
    KEY_MINUS,
    KEY_EQUAL,
    KEY_BACKSPACE,
    KEY_TAB,
    KEY_Q,
    KEY_W,
    KEY_E,
    KEY_R,
    KEY_T,
    KEY_Y,
    KEY_U,
    KEY_I,
    KEY_O,
    KEY_P,
    KEY_LEFTBRACE,
    KEY_RIGHTBRACE,
    KEY_ENTER,
    KEY_LEFTCTRL,
    KEY_A,
    KEY_S,
    KEY_D,
    KEY_F,
    KEY_G,
    KEY_H,
    KEY_J,
    KEY_K,
    KEY_L,
    KEY_SEMICOLON,
    KEY_APOSTROPHE,
    KEY_GRAVE,
    KEY_LEFTSHIFT,
    KEY_BACKSLASH,
    KEY_Z,
    KEY_X,
    KEY_C,
    KEY_V,
    KEY_B,
    KEY_N,
    KEY_M,
    KEY_COMMA,
    KEY_DOT,
    KEY_SLASH,
    KEY_RIGHTSHIFT,
    KEY_KPASTERISK,
    KEY_LEFTALT,
    KEY_SPACE,
    KEY_CAPSLOCK,
    KEY_F1,
    KEY_F2,
    KEY_F3,
    KEY_F4,
    KEY_F5,
    KEY_F6,
    KEY_F7,
    KEY_F8,
    KEY_F9,
    KEY_F10,
    KEY_NUMLOCK,
    KEY_SCROLLLOCK,
    KEY_KP7,
    KEY_KP8,
    KEY_KP9,
    KEY_KPMINUS,
    KEY_KP4,
    KEY_KP5,
    KEY_KP6,
    KEY_KPPLUS,
    KEY_KP1,
    KEY_KP2,
    KEY_KP3,
    KEY_KP0,
    KEY_KPDOT,

    KEY_ZENKAKUHANKAKU,
    KEY_102ND,
    KEY_F11,
    KEY_F12,
    KEY_RO,
    KEY_KATAKANA,
    KEY_HIRAGANA,
    KEY_HENKAN,
    KEY_KATAKANAHIRAGANA,
    KEY_MUHENKAN,
    KEY_KPJPCOMMA,
    KEY_KPENTER,
    KEY_RIGHTCTRL,
    KEY_KPSLASH,
    KEY_SYSRQ,
    KEY_RIGHTALT,
    KEY_LINEFEED,
    KEY_HOME,
    KEY_UP,
    KEY_PAGEUP,
    KEY_LEFT,
    KEY_RIGHT,
    KEY_END,
    KEY_DOWN,
    KEY_PAGEDOWN,
    KEY_INSERT,
    KEY_DELETE,
    KEY_MACRO,
    KEY_MUTE,
    KEY_VOLUMEDOWN,
    KEY_VOLUMEUP,
    KEY_POWER,
    /* SC System Power Down */
    KEY_KPEQUAL,
    KEY_KPPLUSMINUS,
    KEY_PAUSE,
    KEY_SCALE,
    /* AL Compiz Scale  = Expose */
    KEY_KPCOMMA,
    KEY_HANGEUL,
    KEY_HANJA,
    KEY_YEN,
    KEY_LEFTMETA,
    KEY_RIGHTMETA,
    KEY_COMPOSE,

    KEY_STOP,
    /* AC Stop */
    KEY_AGAIN,
    KEY_PROPS,
    /* AC Properties */
    KEY_UNDO,
    /* AC Undo */
    KEY_FRONT,
    KEY_COPY,
    /* AC Copy */
    KEY_OPEN,
    /* AC Open */
    KEY_PASTE,
    /* AC Paste */
    KEY_FIND,
    /* AC Search */
    KEY_CUT,
    /* AC Cut */
    KEY_HELP,
    /* AL Integrated Help Center */
    KEY_MENU,
    /* Menu  = show menu */
    KEY_CALC,
    /* AL Calculator */
    KEY_SETUP,
    KEY_SLEEP,
    /* SC System Sleep */
    KEY_WAKEUP,
    /* System Wake Up */
    KEY_FILE,
    /* AL Local Machine Browser */
    KEY_SENDFILE,
    KEY_DELETEFILE,
    KEY_XFER,
    KEY_PROG1,
    KEY_PROG2,
    KEY_WWW,
    /* AL Internet Browser */
    KEY_MSDOS,
    /* AL Terminal Lock/Screensaver */
    KEY_SCREENLOCK,
    KEY_ROTATE_DISPLAY,
    KEY_CYCLEWINDOWS,
    KEY_MAIL,
    KEY_BOOKMARKS,
    /* AC Bookmarks */
    KEY_COMPUTER,
    KEY_BACK,
    /* AC Back */
    KEY_FORWARD,
    /* AC Forward */
    KEY_CLOSECD,
    KEY_EJECTCD,
    KEY_EJECTCLOSECD,
    KEY_NEXTSONG,
    KEY_PLAYPAUSE,
    KEY_PREVIOUSSONG,
    KEY_STOPCD,
    KEY_RECORD,
    KEY_REWIND,
    KEY_PHONE,
    /* Media Select Telephone */
    KEY_ISO,
    KEY_CONFIG,
    /* AL Consumer Control Configuration */
    KEY_HOMEPAGE,
    /* AC Home */
    KEY_REFRESH,
    /* AC Refresh */
    KEY_EXIT,
    /* AC Exit */
    KEY_MOVE,
    KEY_EDIT,
    KEY_SCROLLUP,
    KEY_SCROLLDOWN,
    KEY_KPLEFTPAREN,
    KEY_KPRIGHTPAREN,
    KEY_NEW,
    /* AC New */
    KEY_REDO,
    /* AC Redo/Repeat */
    //Mouse
    MOUSE_LEFT,
    MOUSE_RIGHT,
    MOUSE_MIDDLE,
    MOUSE_SIDE,
    MOUSE_EXTRA,
    MOUSE_FORWARD,
    MOUSE_BACK,
    MOUSE_TASK,
}


impl KeyCode {
    #[cfg(all(target_os = "linux", feature = "enigo-always"))]
    pub fn convert(&self) -> Result<Key> {
        match self {
            KeyCode::KEY_ESC => Ok(Key::Other(key_codes::KEY_ESC as u32)),
            KeyCode::KEY_1 => Ok(Key::Other(key_codes::KEY_1 as u32)),
            KeyCode::KEY_2 => Ok(Key::Other(key_codes::KEY_2 as u32)),
            KeyCode::KEY_3 => Ok(Key::Other(key_codes::KEY_3 as u32)),
            KeyCode::KEY_4 => Ok(Key::Other(key_codes::KEY_4 as u32)),
            KeyCode::KEY_5 => Ok(Key::Other(key_codes::KEY_5 as u32)),
            KeyCode::KEY_6 => Ok(Key::Other(key_codes::KEY_6 as u32)),
            KeyCode::KEY_7 => Ok(Key::Other(key_codes::KEY_7 as u32)),
            KeyCode::KEY_8 => Ok(Key::Other(key_codes::KEY_8 as u32)),
            KeyCode::KEY_9 => Ok(Key::Other(key_codes::KEY_9 as u32)),
            KeyCode::KEY_10 => Ok(Key::Other(key_codes::KEY_10 as u32)),
            KeyCode::KEY_MINUS => Ok(Key::Other(key_codes::KEY_MINUS as u32)),
            KeyCode::KEY_EQUAL => Ok(Key::Other(key_codes::KEY_EQUAL as u32)),
            KeyCode::KEY_BACKSPACE => Ok(Key::Other(key_codes::KEY_BACKSPACE as u32)),
            KeyCode::KEY_TAB => Ok(Key::Other(key_codes::KEY_TAB as u32)),
            KeyCode::KEY_Q => Ok(Key::Other(key_codes::KEY_Q as u32)),
            KeyCode::KEY_W => Ok(Key::Other(key_codes::KEY_W as u32)),
            KeyCode::KEY_E => Ok(Key::Other(key_codes::KEY_E as u32)),
            KeyCode::KEY_R => Ok(Key::Other(key_codes::KEY_R as u32)),
            KeyCode::KEY_T => Ok(Key::Other(key_codes::KEY_T as u32)),
            KeyCode::KEY_Y => Ok(Key::Other(key_codes::KEY_Y as u32)),
            KeyCode::KEY_U => Ok(Key::Other(key_codes::KEY_U as u32)),
            KeyCode::KEY_I => Ok(Key::Other(key_codes::KEY_I as u32)),
            KeyCode::KEY_O => Ok(Key::Other(key_codes::KEY_O as u32)),
            KeyCode::KEY_P => Ok(Key::Other(key_codes::KEY_P as u32)),
            KeyCode::KEY_LEFTBRACE => Ok(Key::Other(key_codes::KEY_LEFTBRACE as u32)),
            KeyCode::KEY_RIGHTBRACE => Ok(Key::Other(key_codes::KEY_RIGHTBRACE as u32)),
            KeyCode::KEY_ENTER => Ok(Key::Other(key_codes::KEY_ENTER as u32)),
            KeyCode::KEY_LEFTCTRL => Ok(Key::Other(key_codes::KEY_LEFTCTRL as u32)),
            KeyCode::KEY_A => Ok(Key::Other(key_codes::KEY_A as u32)),
            KeyCode::KEY_S => Ok(Key::Other(key_codes::KEY_S as u32)),
            KeyCode::KEY_D => Ok(Key::Other(key_codes::KEY_D as u32)),
            KeyCode::KEY_F => Ok(Key::Other(key_codes::KEY_F as u32)),
            KeyCode::KEY_G => Ok(Key::Other(key_codes::KEY_G as u32)),
            KeyCode::KEY_H => Ok(Key::Other(key_codes::KEY_H as u32)),
            KeyCode::KEY_J => Ok(Key::Other(key_codes::KEY_J as u32)),
            KeyCode::KEY_K => Ok(Key::Other(key_codes::KEY_K as u32)),
            KeyCode::KEY_L => Ok(Key::Other(key_codes::KEY_L as u32)),
            KeyCode::KEY_SEMICOLON => Ok(Key::Other(key_codes::KEY_SEMICOLON as u32)),
            KeyCode::KEY_APOSTROPHE => Ok(Key::Other(key_codes::KEY_APOSTROPHE as u32)),
            KeyCode::KEY_GRAVE => Ok(Key::Other(key_codes::KEY_GRAVE as u32)),
            KeyCode::KEY_LEFTSHIFT => Ok(Key::Other(key_codes::KEY_LEFTSHIFT as u32)),
            KeyCode::KEY_BACKSLASH => Ok(Key::Other(key_codes::KEY_BACKSLASH as u32)),
            KeyCode::KEY_Z => Ok(Key::Other(key_codes::KEY_Z as u32)),
            KeyCode::KEY_X => Ok(Key::Other(key_codes::KEY_X as u32)),
            KeyCode::KEY_C => Ok(Key::Other(key_codes::KEY_C as u32)),
            KeyCode::KEY_V => Ok(Key::Other(key_codes::KEY_V as u32)),
            KeyCode::KEY_B => Ok(Key::Other(key_codes::KEY_B as u32)),
            KeyCode::KEY_N => Ok(Key::Other(key_codes::KEY_N as u32)),
            KeyCode::KEY_M => Ok(Key::Other(key_codes::KEY_M as u32)),
            KeyCode::KEY_COMMA => Ok(Key::Other(key_codes::KEY_COMMA as u32)),
            KeyCode::KEY_DOT => Ok(Key::Other(key_codes::KEY_DOT as u32)),
            KeyCode::KEY_SLASH => Ok(Key::Other(key_codes::KEY_SLASH as u32)),
            KeyCode::KEY_RIGHTSHIFT => Ok(Key::Other(key_codes::KEY_RIGHTSHIFT as u32)),
            KeyCode::KEY_KPASTERISK => Ok(Key::Other(key_codes::KEY_KPASTERISK as u32)),
            KeyCode::KEY_LEFTALT => Ok(Key::Other(key_codes::KEY_LEFTALT as u32)),
            KeyCode::KEY_SPACE => Ok(Key::Other(key_codes::KEY_SPACE as u32)),
            KeyCode::KEY_CAPSLOCK => Ok(Key::Other(key_codes::KEY_CAPSLOCK as u32)),
            KeyCode::KEY_F1 => Ok(Key::Other(key_codes::KEY_F1 as u32)),
            KeyCode::KEY_F2 => Ok(Key::Other(key_codes::KEY_F2 as u32)),
            KeyCode::KEY_F3 => Ok(Key::Other(key_codes::KEY_F3 as u32)),
            KeyCode::KEY_F4 => Ok(Key::Other(key_codes::KEY_F4 as u32)),
            KeyCode::KEY_F5 => Ok(Key::Other(key_codes::KEY_F5 as u32)),
            KeyCode::KEY_F6 => Ok(Key::Other(key_codes::KEY_F6 as u32)),
            KeyCode::KEY_F7 => Ok(Key::Other(key_codes::KEY_F7 as u32)),
            KeyCode::KEY_F8 => Ok(Key::Other(key_codes::KEY_F8 as u32)),
            KeyCode::KEY_F9 => Ok(Key::Other(key_codes::KEY_F9 as u32)),
            KeyCode::KEY_F10 => Ok(Key::Other(key_codes::KEY_F10 as u32)),
            KeyCode::KEY_NUMLOCK => Ok(Key::Other(key_codes::KEY_NUMLOCK as u32)),
            KeyCode::KEY_SCROLLLOCK => Ok(Key::Other(key_codes::KEY_SCROLLLOCK as u32)),
            KeyCode::KEY_KP7 => Ok(Key::Other(key_codes::KEY_KP7 as u32)),
            KeyCode::KEY_KP8 => Ok(Key::Other(key_codes::KEY_KP8 as u32)),
            KeyCode::KEY_KP9 => Ok(Key::Other(key_codes::KEY_KP9 as u32)),
            KeyCode::KEY_KPMINUS => Ok(Key::Other(key_codes::KEY_KPMINUS as u32)),
            KeyCode::KEY_KP4 => Ok(Key::Other(key_codes::KEY_KP4 as u32)),
            KeyCode::KEY_KP5 => Ok(Key::Other(key_codes::KEY_KP5 as u32)),
            KeyCode::KEY_KP6 => Ok(Key::Other(key_codes::KEY_KP6 as u32)),
            KeyCode::KEY_KPPLUS => Ok(Key::Other(key_codes::KEY_KPPLUS as u32)),
            KeyCode::KEY_KP1 => Ok(Key::Other(key_codes::KEY_KP1 as u32)),
            KeyCode::KEY_KP2 => Ok(Key::Other(key_codes::KEY_KP2 as u32)),
            KeyCode::KEY_KP3 => Ok(Key::Other(key_codes::KEY_KP3 as u32)),
            KeyCode::KEY_KP0 => Ok(Key::Other(key_codes::KEY_KP0 as u32)),
            KeyCode::KEY_KPDOT => Ok(Key::Other(key_codes::KEY_KPDOT as u32)),
            KeyCode::KEY_ZENKAKUHANKAKU => Ok(Key::Other(key_codes::KEY_ZENKAKUHANKAKU as u32)),
            KeyCode::KEY_102ND => Ok(Key::Other(key_codes::KEY_102ND as u32)),
            KeyCode::KEY_F11 => Ok(Key::Other(key_codes::KEY_F11 as u32)),
            KeyCode::KEY_F12 => Ok(Key::Other(key_codes::KEY_F12 as u32)),
            KeyCode::KEY_RO => Ok(Key::Other(key_codes::KEY_RO as u32)),
            KeyCode::KEY_KATAKANA => Ok(Key::Other(key_codes::KEY_KATAKANA as u32)),
            KeyCode::KEY_HIRAGANA => Ok(Key::Other(key_codes::KEY_HIRAGANA as u32)),
            KeyCode::KEY_HENKAN => Ok(Key::Other(key_codes::KEY_HENKAN as u32)),
            KeyCode::KEY_KATAKANAHIRAGANA => Ok(Key::Other(key_codes::KEY_KATAKANAHIRAGANA as u32)),
            KeyCode::KEY_MUHENKAN => Ok(Key::Other(key_codes::KEY_MUHENKAN as u32)),
            KeyCode::KEY_KPJPCOMMA => Ok(Key::Other(key_codes::KEY_KPJPCOMMA as u32)),
            KeyCode::KEY_KPENTER => Ok(Key::Other(key_codes::KEY_KPENTER as u32)),
            KeyCode::KEY_RIGHTCTRL => Ok(Key::Other(key_codes::KEY_RIGHTCTRL as u32)),
            KeyCode::KEY_KPSLASH => Ok(Key::Other(key_codes::KEY_KPSLASH as u32)),
            KeyCode::KEY_SYSRQ => Ok(Key::Other(key_codes::KEY_SYSRQ as u32)),
            KeyCode::KEY_RIGHTALT => Ok(Key::Other(key_codes::KEY_RIGHTALT as u32)),
            KeyCode::KEY_LINEFEED => Ok(Key::Other(key_codes::KEY_LINEFEED as u32)),
            KeyCode::KEY_HOME => Ok(Key::Other(key_codes::KEY_HOME as u32)),
            KeyCode::KEY_UP => Ok(Key::Other(key_codes::KEY_UP as u32)),
            KeyCode::KEY_PAGEUP => Ok(Key::Other(key_codes::KEY_PAGEUP as u32)),
            KeyCode::KEY_LEFT => Ok(Key::Other(key_codes::KEY_LEFT as u32)),
            KeyCode::KEY_RIGHT => Ok(Key::Other(key_codes::KEY_RIGHT as u32)),
            KeyCode::KEY_END => Ok(Key::Other(key_codes::KEY_END as u32)),
            KeyCode::KEY_DOWN => Ok(Key::Other(key_codes::KEY_DOWN as u32)),
            KeyCode::KEY_PAGEDOWN => Ok(Key::Other(key_codes::KEY_PAGEDOWN as u32)),
            KeyCode::KEY_INSERT => Ok(Key::Other(key_codes::KEY_INSERT as u32)),
            KeyCode::KEY_DELETE => Ok(Key::Other(key_codes::KEY_DELETE as u32)),
            KeyCode::KEY_MACRO => Ok(Key::Other(key_codes::KEY_MACRO as u32)),
            KeyCode::KEY_MUTE => Ok(Key::Other(key_codes::KEY_MUTE as u32)),
            KeyCode::KEY_VOLUMEDOWN => Ok(Key::Other(key_codes::KEY_VOLUMEDOWN as u32)),
            KeyCode::KEY_VOLUMEUP => Ok(Key::Other(key_codes::KEY_VOLUMEUP as u32)),
            KeyCode::KEY_POWER => Ok(Key::Other(key_codes::KEY_POWER as u32)),
            KeyCode::KEY_KPEQUAL => Ok(Key::Other(key_codes::KEY_KPEQUAL as u32)),
            KeyCode::KEY_KPPLUSMINUS => Ok(Key::Other(key_codes::KEY_KPPLUSMINUS as u32)),
            KeyCode::KEY_PAUSE => Ok(Key::Other(key_codes::KEY_PAUSE as u32)),
            KeyCode::KEY_SCALE => Ok(Key::Other(key_codes::KEY_SCALE as u32)),
            KeyCode::KEY_KPCOMMA => Ok(Key::Other(key_codes::KEY_KPCOMMA as u32)),
            KeyCode::KEY_HANGEUL => Ok(Key::Other(key_codes::KEY_HANGEUL as u32)),
            KeyCode::KEY_HANJA => Ok(Key::Other(key_codes::KEY_HANJA as u32)),
            KeyCode::KEY_YEN => Ok(Key::Other(key_codes::KEY_YEN as u32)),
            KeyCode::KEY_LEFTMETA => Ok(Key::Other(key_codes::KEY_LEFTMETA as u32)),
            KeyCode::KEY_RIGHTMETA => Ok(Key::Other(key_codes::KEY_RIGHTMETA as u32)),
            KeyCode::KEY_COMPOSE => Ok(Key::Other(key_codes::KEY_COMPOSE as u32)),
            KeyCode::KEY_STOP => Ok(Key::Other(key_codes::KEY_STOP as u32)),
            KeyCode::KEY_AGAIN => Ok(Key::Other(key_codes::KEY_AGAIN as u32)),
            KeyCode::KEY_PROPS => Ok(Key::Other(key_codes::KEY_PROPS as u32)),
            KeyCode::KEY_UNDO => Ok(Key::Other(key_codes::KEY_UNDO as u32)),
            KeyCode::KEY_FRONT => Ok(Key::Other(key_codes::KEY_FRONT as u32)),
            KeyCode::KEY_COPY => Ok(Key::Other(key_codes::KEY_COPY as u32)),
            KeyCode::KEY_OPEN => Ok(Key::Other(key_codes::KEY_OPEN as u32)),
            KeyCode::KEY_PASTE => Ok(Key::Other(key_codes::KEY_PASTE as u32)),
            KeyCode::KEY_FIND => Ok(Key::Other(key_codes::KEY_FIND as u32)),
            KeyCode::KEY_CUT => Ok(Key::Other(key_codes::KEY_CUT as u32)),
            KeyCode::KEY_HELP => Ok(Key::Other(key_codes::KEY_HELP as u32)),
            KeyCode::KEY_MENU => Ok(Key::Other(key_codes::KEY_MENU as u32)),
            KeyCode::KEY_CALC => Ok(Key::Other(key_codes::KEY_CALC as u32)),
            KeyCode::KEY_SETUP => Ok(Key::Other(key_codes::KEY_SETUP as u32)),
            KeyCode::KEY_SLEEP => Ok(Key::Other(key_codes::KEY_SLEEP as u32)),
            KeyCode::KEY_WAKEUP => Ok(Key::Other(key_codes::KEY_WAKEUP as u32)),
            KeyCode::KEY_FILE => Ok(Key::Other(key_codes::KEY_FILE as u32)),
            KeyCode::KEY_SENDFILE => Ok(Key::Other(key_codes::KEY_SENDFILE as u32)),
            KeyCode::KEY_DELETEFILE => Ok(Key::Other(key_codes::KEY_DELETEFILE as u32)),
            KeyCode::KEY_XFER => Ok(Key::Other(key_codes::KEY_XFER as u32)),
            KeyCode::KEY_PROG1 => Ok(Key::Other(key_codes::KEY_PROG1 as u32)),
            KeyCode::KEY_PROG2 => Ok(Key::Other(key_codes::KEY_PROG2 as u32)),
            KeyCode::KEY_WWW => Ok(Key::Other(key_codes::KEY_WWW as u32)),
            KeyCode::KEY_MSDOS => Ok(Key::Other(key_codes::KEY_MSDOS as u32)),
            KeyCode::KEY_SCREENLOCK => Ok(Key::Other(key_codes::KEY_SCREENLOCK as u32)),
            KeyCode::KEY_ROTATE_DISPLAY => Ok(Key::Other(key_codes::KEY_ROTATE_DISPLAY as u32)),
            KeyCode::KEY_CYCLEWINDOWS => Ok(Key::Other(key_codes::KEY_CYCLEWINDOWS as u32)),
            KeyCode::KEY_MAIL => Ok(Key::Other(key_codes::KEY_MAIL as u32)),
            KeyCode::KEY_BOOKMARKS => Ok(Key::Other(key_codes::KEY_BOOKMARKS as u32)),
            KeyCode::KEY_COMPUTER => Ok(Key::Other(key_codes::KEY_COMPUTER as u32)),
            KeyCode::KEY_BACK => Ok(Key::Other(key_codes::KEY_BACK as u32)),
            KeyCode::KEY_FORWARD => Ok(Key::Other(key_codes::KEY_FORWARD as u32)),
            KeyCode::KEY_CLOSECD => Ok(Key::Other(key_codes::KEY_CLOSECD as u32)),
            KeyCode::KEY_EJECTCD => Ok(Key::Other(key_codes::KEY_EJECTCD as u32)),
            KeyCode::KEY_EJECTCLOSECD => Ok(Key::Other(key_codes::KEY_EJECTCLOSECD as u32)),
            KeyCode::KEY_NEXTSONG => Ok(Key::Other(key_codes::KEY_NEXTSONG as u32)),
            KeyCode::KEY_PLAYPAUSE => Ok(Key::Other(key_codes::KEY_PLAYPAUSE as u32)),
            KeyCode::KEY_PREVIOUSSONG => Ok(Key::Other(key_codes::KEY_PREVIOUSSONG as u32)),
            KeyCode::KEY_STOPCD => Ok(Key::Other(key_codes::KEY_STOPCD as u32)),
            KeyCode::KEY_RECORD => Ok(Key::Other(key_codes::KEY_RECORD as u32)),
            KeyCode::KEY_REWIND => Ok(Key::Other(key_codes::KEY_REWIND as u32)),
            KeyCode::KEY_PHONE => Ok(Key::Other(key_codes::KEY_PHONE as u32)),
            KeyCode::KEY_ISO => Ok(Key::Other(key_codes::KEY_ISO as u32)),
            KeyCode::KEY_CONFIG => Ok(Key::Other(key_codes::KEY_CONFIG as u32)),
            KeyCode::KEY_HOMEPAGE => Ok(Key::Other(key_codes::KEY_HOMEPAGE as u32)),
            KeyCode::KEY_REFRESH => Ok(Key::Other(key_codes::KEY_REFRESH as u32)),
            KeyCode::KEY_EXIT => Ok(Key::Other(key_codes::KEY_EXIT as u32)),
            KeyCode::KEY_MOVE => Ok(Key::Other(key_codes::KEY_MOVE as u32)),
            KeyCode::KEY_EDIT => Ok(Key::Other(key_codes::KEY_EDIT as u32)),
            KeyCode::KEY_SCROLLUP => Ok(Key::Other(key_codes::KEY_SCROLLUP as u32)),
            KeyCode::KEY_SCROLLDOWN => Ok(Key::Other(key_codes::KEY_SCROLLDOWN as u32)),
            KeyCode::KEY_KPLEFTPAREN => Ok(Key::Other(key_codes::KEY_KPLEFTPAREN as u32)),
            KeyCode::KEY_KPRIGHTPAREN => Ok(Key::Other(key_codes::KEY_KPRIGHTPAREN as u32)),
            KeyCode::KEY_NEW => Ok(Key::Other(key_codes::KEY_NEW as u32)),
            KeyCode::KEY_REDO => Ok(Key::Other(key_codes::KEY_REDO as u32)),
            value => bail!("No such key code: {value}"),
        }
    }
    
    #[cfg(all(target_os = "linux", not(feature = "enigo-always"), not(feature = "use-tfc")))]
    pub fn convert(&self) -> Result<Button> {
        match self {
            KeyCode::KEY_ESC => Ok(key_codes::KEY_ESC),
            KeyCode::KEY_1 => Ok(key_codes::KEY_1),
            KeyCode::KEY_2 => Ok(key_codes::KEY_2),
            KeyCode::KEY_3 => Ok(key_codes::KEY_3),
            KeyCode::KEY_4 => Ok(key_codes::KEY_4),
            KeyCode::KEY_5 => Ok(key_codes::KEY_5),
            KeyCode::KEY_6 => Ok(key_codes::KEY_6),
            KeyCode::KEY_7 => Ok(key_codes::KEY_7),
            KeyCode::KEY_8 => Ok(key_codes::KEY_8),
            KeyCode::KEY_9 => Ok(key_codes::KEY_9),
            KeyCode::KEY_10 => Ok(key_codes::KEY_10),
            KeyCode::KEY_MINUS => Ok(key_codes::KEY_MINUS),
            KeyCode::KEY_EQUAL => Ok(key_codes::KEY_EQUAL),
            KeyCode::KEY_BACKSPACE => Ok(key_codes::KEY_BACKSPACE),
            KeyCode::KEY_TAB => Ok(key_codes::KEY_TAB),
            KeyCode::KEY_Q => Ok(key_codes::KEY_Q),
            KeyCode::KEY_W => Ok(key_codes::KEY_W),
            KeyCode::KEY_E => Ok(key_codes::KEY_E),
            KeyCode::KEY_R => Ok(key_codes::KEY_R),
            KeyCode::KEY_T => Ok(key_codes::KEY_T),
            KeyCode::KEY_Y => Ok(key_codes::KEY_Y),
            KeyCode::KEY_U => Ok(key_codes::KEY_U),
            KeyCode::KEY_I => Ok(key_codes::KEY_I),
            KeyCode::KEY_O => Ok(key_codes::KEY_O),
            KeyCode::KEY_P => Ok(key_codes::KEY_P),
            KeyCode::KEY_LEFTBRACE => Ok(key_codes::KEY_LEFTBRACE),
            KeyCode::KEY_RIGHTBRACE => Ok(key_codes::KEY_RIGHTBRACE),
            KeyCode::KEY_ENTER => Ok(key_codes::KEY_ENTER),
            KeyCode::KEY_LEFTCTRL => Ok(key_codes::KEY_LEFTCTRL),
            KeyCode::KEY_A => Ok(key_codes::KEY_A),
            KeyCode::KEY_S => Ok(key_codes::KEY_S),
            KeyCode::KEY_D => Ok(key_codes::KEY_D),
            KeyCode::KEY_F => Ok(key_codes::KEY_F),
            KeyCode::KEY_G => Ok(key_codes::KEY_G),
            KeyCode::KEY_H => Ok(key_codes::KEY_H),
            KeyCode::KEY_J => Ok(key_codes::KEY_J),
            KeyCode::KEY_K => Ok(key_codes::KEY_K),
            KeyCode::KEY_L => Ok(key_codes::KEY_L),
            KeyCode::KEY_SEMICOLON => Ok(key_codes::KEY_SEMICOLON),
            KeyCode::KEY_APOSTROPHE => Ok(key_codes::KEY_APOSTROPHE),
            KeyCode::KEY_GRAVE => Ok(key_codes::KEY_GRAVE),
            KeyCode::KEY_LEFTSHIFT => Ok(key_codes::KEY_LEFTSHIFT),
            KeyCode::KEY_BACKSLASH => Ok(key_codes::KEY_BACKSLASH),
            KeyCode::KEY_Z => Ok(key_codes::KEY_Z),
            KeyCode::KEY_X => Ok(key_codes::KEY_X),
            KeyCode::KEY_C => Ok(key_codes::KEY_C),
            KeyCode::KEY_V => Ok(key_codes::KEY_V),
            KeyCode::KEY_B => Ok(key_codes::KEY_B),
            KeyCode::KEY_N => Ok(key_codes::KEY_N),
            KeyCode::KEY_M => Ok(key_codes::KEY_M),
            KeyCode::KEY_COMMA => Ok(key_codes::KEY_COMMA),
            KeyCode::KEY_DOT => Ok(key_codes::KEY_DOT),
            KeyCode::KEY_SLASH => Ok(key_codes::KEY_SLASH),
            KeyCode::KEY_RIGHTSHIFT => Ok(key_codes::KEY_RIGHTSHIFT),
            KeyCode::KEY_KPASTERISK => Ok(key_codes::KEY_KPASTERISK),
            KeyCode::KEY_LEFTALT => Ok(key_codes::KEY_LEFTALT),
            KeyCode::KEY_SPACE => Ok(key_codes::KEY_SPACE),
            KeyCode::KEY_CAPSLOCK => Ok(key_codes::KEY_CAPSLOCK),
            KeyCode::KEY_F1 => Ok(key_codes::KEY_F1),
            KeyCode::KEY_F2 => Ok(key_codes::KEY_F2),
            KeyCode::KEY_F3 => Ok(key_codes::KEY_F3),
            KeyCode::KEY_F4 => Ok(key_codes::KEY_F4),
            KeyCode::KEY_F5 => Ok(key_codes::KEY_F5),
            KeyCode::KEY_F6 => Ok(key_codes::KEY_F6),
            KeyCode::KEY_F7 => Ok(key_codes::KEY_F7),
            KeyCode::KEY_F8 => Ok(key_codes::KEY_F8),
            KeyCode::KEY_F9 => Ok(key_codes::KEY_F9),
            KeyCode::KEY_F10 => Ok(key_codes::KEY_F10),
            KeyCode::KEY_NUMLOCK => Ok(key_codes::KEY_NUMLOCK),
            KeyCode::KEY_SCROLLLOCK => Ok(key_codes::KEY_SCROLLLOCK),
            KeyCode::KEY_KP7 => Ok(key_codes::KEY_KP7),
            KeyCode::KEY_KP8 => Ok(key_codes::KEY_KP8),
            KeyCode::KEY_KP9 => Ok(key_codes::KEY_KP9),
            KeyCode::KEY_KPMINUS => Ok(key_codes::KEY_KPMINUS),
            KeyCode::KEY_KP4 => Ok(key_codes::KEY_KP4),
            KeyCode::KEY_KP5 => Ok(key_codes::KEY_KP5),
            KeyCode::KEY_KP6 => Ok(key_codes::KEY_KP6),
            KeyCode::KEY_KPPLUS => Ok(key_codes::KEY_KPPLUS),
            KeyCode::KEY_KP1 => Ok(key_codes::KEY_KP1),
            KeyCode::KEY_KP2 => Ok(key_codes::KEY_KP2),
            KeyCode::KEY_KP3 => Ok(key_codes::KEY_KP3),
            KeyCode::KEY_KP0 => Ok(key_codes::KEY_KP0),
            KeyCode::KEY_KPDOT => Ok(key_codes::KEY_KPDOT),
            KeyCode::KEY_ZENKAKUHANKAKU => Ok(key_codes::KEY_ZENKAKUHANKAKU),
            KeyCode::KEY_102ND => Ok(key_codes::KEY_102ND),
            KeyCode::KEY_F11 => Ok(key_codes::KEY_F11),
            KeyCode::KEY_F12 => Ok(key_codes::KEY_F12),
            KeyCode::KEY_RO => Ok(key_codes::KEY_RO),
            KeyCode::KEY_KATAKANA => Ok(key_codes::KEY_KATAKANA),
            KeyCode::KEY_HIRAGANA => Ok(key_codes::KEY_HIRAGANA),
            KeyCode::KEY_HENKAN => Ok(key_codes::KEY_HENKAN),
            KeyCode::KEY_KATAKANAHIRAGANA => Ok(key_codes::KEY_KATAKANAHIRAGANA),
            KeyCode::KEY_MUHENKAN => Ok(key_codes::KEY_MUHENKAN),
            KeyCode::KEY_KPJPCOMMA => Ok(key_codes::KEY_KPJPCOMMA),
            KeyCode::KEY_KPENTER => Ok(key_codes::KEY_KPENTER),
            KeyCode::KEY_RIGHTCTRL => Ok(key_codes::KEY_RIGHTCTRL),
            KeyCode::KEY_KPSLASH => Ok(key_codes::KEY_KPSLASH),
            KeyCode::KEY_SYSRQ => Ok(key_codes::KEY_SYSRQ),
            KeyCode::KEY_RIGHTALT => Ok(key_codes::KEY_RIGHTALT),
            KeyCode::KEY_LINEFEED => Ok(key_codes::KEY_LINEFEED),
            KeyCode::KEY_HOME => Ok(key_codes::KEY_HOME),
            KeyCode::KEY_UP => Ok(key_codes::KEY_UP),
            KeyCode::KEY_PAGEUP => Ok(key_codes::KEY_PAGEUP),
            KeyCode::KEY_LEFT => Ok(key_codes::KEY_LEFT),
            KeyCode::KEY_RIGHT => Ok(key_codes::KEY_RIGHT),
            KeyCode::KEY_END => Ok(key_codes::KEY_END),
            KeyCode::KEY_DOWN => Ok(key_codes::KEY_DOWN),
            KeyCode::KEY_PAGEDOWN => Ok(key_codes::KEY_PAGEDOWN),
            KeyCode::KEY_INSERT => Ok(key_codes::KEY_INSERT),
            KeyCode::KEY_DELETE => Ok(key_codes::KEY_DELETE),
            KeyCode::KEY_MACRO => Ok(key_codes::KEY_MACRO),
            KeyCode::KEY_MUTE => Ok(key_codes::KEY_MUTE),
            KeyCode::KEY_VOLUMEDOWN => Ok(key_codes::KEY_VOLUMEDOWN),
            KeyCode::KEY_VOLUMEUP => Ok(key_codes::KEY_VOLUMEUP),
            KeyCode::KEY_POWER => Ok(key_codes::KEY_POWER),
            KeyCode::KEY_KPEQUAL => Ok(key_codes::KEY_KPEQUAL),
            KeyCode::KEY_KPPLUSMINUS => Ok(key_codes::KEY_KPPLUSMINUS),
            KeyCode::KEY_PAUSE => Ok(key_codes::KEY_PAUSE),
            KeyCode::KEY_SCALE => Ok(key_codes::KEY_SCALE),
            KeyCode::KEY_KPCOMMA => Ok(key_codes::KEY_KPCOMMA),
            KeyCode::KEY_HANGEUL => Ok(key_codes::KEY_HANGEUL),
            KeyCode::KEY_HANJA => Ok(key_codes::KEY_HANJA),
            KeyCode::KEY_YEN => Ok(key_codes::KEY_YEN),
            KeyCode::KEY_LEFTMETA => Ok(key_codes::KEY_LEFTMETA),
            KeyCode::KEY_RIGHTMETA => Ok(key_codes::KEY_RIGHTMETA),
            KeyCode::KEY_COMPOSE => Ok(key_codes::KEY_COMPOSE),
            KeyCode::KEY_STOP => Ok(key_codes::KEY_STOP),
            KeyCode::KEY_AGAIN => Ok(key_codes::KEY_AGAIN),
            KeyCode::KEY_PROPS => Ok(key_codes::KEY_PROPS),
            KeyCode::KEY_UNDO => Ok(key_codes::KEY_UNDO),
            KeyCode::KEY_FRONT => Ok(key_codes::KEY_FRONT),
            KeyCode::KEY_COPY => Ok(key_codes::KEY_COPY),
            KeyCode::KEY_OPEN => Ok(key_codes::KEY_OPEN),
            KeyCode::KEY_PASTE => Ok(key_codes::KEY_PASTE),
            KeyCode::KEY_FIND => Ok(key_codes::KEY_FIND),
            KeyCode::KEY_CUT => Ok(key_codes::KEY_CUT),
            KeyCode::KEY_HELP => Ok(key_codes::KEY_HELP),
            KeyCode::KEY_MENU => Ok(key_codes::KEY_MENU),
            KeyCode::KEY_CALC => Ok(key_codes::KEY_CALC),
            KeyCode::KEY_SETUP => Ok(key_codes::KEY_SETUP),
            KeyCode::KEY_SLEEP => Ok(key_codes::KEY_SLEEP),
            KeyCode::KEY_WAKEUP => Ok(key_codes::KEY_WAKEUP),
            KeyCode::KEY_FILE => Ok(key_codes::KEY_FILE),
            KeyCode::KEY_SENDFILE => Ok(key_codes::KEY_SENDFILE),
            KeyCode::KEY_DELETEFILE => Ok(key_codes::KEY_DELETEFILE),
            KeyCode::KEY_XFER => Ok(key_codes::KEY_XFER),
            KeyCode::KEY_PROG1 => Ok(key_codes::KEY_PROG1),
            KeyCode::KEY_PROG2 => Ok(key_codes::KEY_PROG2),
            KeyCode::KEY_WWW => Ok(key_codes::KEY_WWW),
            KeyCode::KEY_MSDOS => Ok(key_codes::KEY_MSDOS),
            KeyCode::KEY_SCREENLOCK => Ok(key_codes::KEY_SCREENLOCK),
            KeyCode::KEY_ROTATE_DISPLAY => Ok(key_codes::KEY_ROTATE_DISPLAY),
            KeyCode::KEY_CYCLEWINDOWS => Ok(key_codes::KEY_CYCLEWINDOWS),
            KeyCode::KEY_MAIL => Ok(key_codes::KEY_MAIL),
            KeyCode::KEY_BOOKMARKS => Ok(key_codes::KEY_BOOKMARKS),
            KeyCode::KEY_COMPUTER => Ok(key_codes::KEY_COMPUTER),
            KeyCode::KEY_BACK => Ok(key_codes::KEY_BACK),
            KeyCode::KEY_FORWARD => Ok(key_codes::KEY_FORWARD),
            KeyCode::KEY_CLOSECD => Ok(key_codes::KEY_CLOSECD),
            KeyCode::KEY_EJECTCD => Ok(key_codes::KEY_EJECTCD),
            KeyCode::KEY_EJECTCLOSECD => Ok(key_codes::KEY_EJECTCLOSECD),
            KeyCode::KEY_NEXTSONG => Ok(key_codes::KEY_NEXTSONG),
            KeyCode::KEY_PLAYPAUSE => Ok(key_codes::KEY_PLAYPAUSE),
            KeyCode::KEY_PREVIOUSSONG => Ok(key_codes::KEY_PREVIOUSSONG),
            KeyCode::KEY_STOPCD => Ok(key_codes::KEY_STOPCD),
            KeyCode::KEY_RECORD => Ok(key_codes::KEY_RECORD),
            KeyCode::KEY_REWIND => Ok(key_codes::KEY_REWIND),
            KeyCode::KEY_PHONE => Ok(key_codes::KEY_PHONE),
            KeyCode::KEY_ISO => Ok(key_codes::KEY_ISO),
            KeyCode::KEY_CONFIG => Ok(key_codes::KEY_CONFIG),
            KeyCode::KEY_HOMEPAGE => Ok(key_codes::KEY_HOMEPAGE),
            KeyCode::KEY_REFRESH => Ok(key_codes::KEY_REFRESH),
            KeyCode::KEY_EXIT => Ok(key_codes::KEY_EXIT),
            KeyCode::KEY_MOVE => Ok(key_codes::KEY_MOVE),
            KeyCode::KEY_EDIT => Ok(key_codes::KEY_EDIT),
            KeyCode::KEY_SCROLLUP => Ok(key_codes::KEY_SCROLLUP),
            KeyCode::KEY_SCROLLDOWN => Ok(key_codes::KEY_SCROLLDOWN),
            KeyCode::KEY_KPLEFTPAREN => Ok(key_codes::KEY_KPLEFTPAREN),
            KeyCode::KEY_KPRIGHTPAREN => Ok(key_codes::KEY_KPRIGHTPAREN),
            KeyCode::KEY_NEW => Ok(key_codes::KEY_NEW),
            KeyCode::KEY_REDO => Ok(key_codes::KEY_REDO),
            KeyCode::MOUSE_LEFT => Ok(key_codes::BTN_LEFT),
            KeyCode::MOUSE_RIGHT => Ok(key_codes::BTN_RIGHT),
            KeyCode::MOUSE_MIDDLE => Ok(key_codes::BTN_MIDDLE),
            KeyCode::MOUSE_SIDE => Ok(key_codes::BTN_SIDE),
            KeyCode::MOUSE_EXTRA => Ok(key_codes::BTN_EXTRA),
            KeyCode::MOUSE_FORWARD => Ok(key_codes::BTN_FORWARD),
            KeyCode::MOUSE_BACK => Ok(key_codes::BTN_BACK),
            KeyCode::MOUSE_TASK => Ok(key_codes::BTN_TASK),
            value => bail!("No such key code: {value}"),
        }
    }

    #[cfg(all(target_os = "linux", feature = "use-tfc"))]
    pub fn convert(&self) -> Result<Key> {
        match self {
            KeyCode::KEY_ESC => Ok(Key::Escape),
            KeyCode::KEY_1 => Ok(Key::N1),
            KeyCode::KEY_2 => Ok(Key::N2),
            KeyCode::KEY_3 => Ok(Key::N3),
            KeyCode::KEY_4 => Ok(Key::N4),
            KeyCode::KEY_5 => Ok(Key::N5),
            KeyCode::KEY_6 => Ok(Key::N6),
            KeyCode::KEY_7 => Ok(Key::N7),
            KeyCode::KEY_8 => Ok(Key::N8),
            KeyCode::KEY_9 => Ok(Key::N9),
            KeyCode::KEY_10 => Ok(Key::N0),
            KeyCode::KEY_MINUS => Ok(Key::Minus),
            KeyCode::KEY_EQUAL => Ok(Key::Equal),
            KeyCode::KEY_BACKSPACE => Ok(Key::DeleteOrBackspace),
            KeyCode::KEY_TAB => Ok(Key::Tab),
            KeyCode::KEY_Q => Ok(Key::Q),
            KeyCode::KEY_W => Ok(Key::W),
            KeyCode::KEY_E => Ok(Key::E),
            KeyCode::KEY_R => Ok(Key::R),
            KeyCode::KEY_T => Ok(Key::T),
            KeyCode::KEY_Y => Ok(Key::Y),
            KeyCode::KEY_U => Ok(Key::U),
            KeyCode::KEY_I => Ok(Key::I),
            KeyCode::KEY_O => Ok(Key::O),
            KeyCode::KEY_P => Ok(Key::P),
            KeyCode::KEY_LEFTBRACE => Ok(Key::LeftBracket),
            KeyCode::KEY_RIGHTBRACE => Ok(Key::RightBracket),
            KeyCode::KEY_ENTER => Ok(Key::ReturnOrEnter),
            KeyCode::KEY_LEFTCTRL => Ok(Key::Control),
            KeyCode::KEY_A => Ok(Key::A),
            KeyCode::KEY_S => Ok(Key::S),
            KeyCode::KEY_D => Ok(Key::D),
            KeyCode::KEY_F => Ok(Key::F),
            KeyCode::KEY_G => Ok(Key::G),
            KeyCode::KEY_H => Ok(Key::H),
            KeyCode::KEY_J => Ok(Key::J),
            KeyCode::KEY_K => Ok(Key::K),
            KeyCode::KEY_L => Ok(Key::L),
            KeyCode::KEY_SEMICOLON => Ok(Key::Semicolon),
            KeyCode::KEY_APOSTROPHE => Ok(Key::Quote),
            KeyCode::KEY_GRAVE => Ok(Key::Grave),
            KeyCode::KEY_LEFTSHIFT => Ok(Key::Shift),
            KeyCode::KEY_BACKSLASH => Ok(Key::Backslash),
            KeyCode::KEY_Z => Ok(Key::Z),
            KeyCode::KEY_X => Ok(Key::X),
            KeyCode::KEY_C => Ok(Key::C),
            KeyCode::KEY_V => Ok(Key::V),
            KeyCode::KEY_B => Ok(Key::B),
            KeyCode::KEY_N => Ok(Key::N),
            KeyCode::KEY_M => Ok(Key::M),
            KeyCode::KEY_COMMA => Ok(Key::Comma),
            KeyCode::KEY_DOT => Ok(Key::Period),
            KeyCode::KEY_SLASH => Ok(Key::Slash),
            KeyCode::KEY_RIGHTSHIFT => Ok(Key::RightShift),
            KeyCode::KEY_LEFTALT => Ok(Key::Alt),
            KeyCode::KEY_SPACE => Ok(Key::Space),
            KeyCode::KEY_CAPSLOCK => Ok(Key::CapsLock),
            KeyCode::KEY_F1 => Ok(Key::F1),
            KeyCode::KEY_F2 => Ok(Key::F2),
            KeyCode::KEY_F3 => Ok(Key::F3),
            KeyCode::KEY_F4 => Ok(Key::F4),
            KeyCode::KEY_F5 => Ok(Key::F5),
            KeyCode::KEY_F6 => Ok(Key::F6),
            KeyCode::KEY_F7 => Ok(Key::F7),
            KeyCode::KEY_F8 => Ok(Key::F8),
            KeyCode::KEY_F9 => Ok(Key::F9),
            KeyCode::KEY_F10 => Ok(Key::F10),
            KeyCode::KEY_KP7 => Ok(Key::Numpad7),
            KeyCode::KEY_KP8 => Ok(Key::Numpad8),
            KeyCode::KEY_KP9 => Ok(Key::Numpad9),
            KeyCode::KEY_KPMINUS => Ok(Key::NumpadMinus),
            KeyCode::KEY_KP4 => Ok(Key::Numpad4),
            KeyCode::KEY_KP5 => Ok(Key::Numpad5),
            KeyCode::KEY_KP6 => Ok(Key::Numpad6),
            KeyCode::KEY_KPPLUS => Ok(Key::NumpadPlus),
            KeyCode::KEY_KP1 => Ok(Key::Numpad1),
            KeyCode::KEY_KP2 => Ok(Key::Numpad2),
            KeyCode::KEY_KP3 => Ok(Key::Numpad3),
            KeyCode::KEY_KP0 => Ok(Key::Numpad0),
            KeyCode::KEY_KPDOT => Ok(Key::NumpadDecimal),
            KeyCode::KEY_F11 => Ok(Key::F11),
            KeyCode::KEY_F12 => Ok(Key::F12),
            KeyCode::KEY_KPENTER => Ok(Key::NumpadEnter),
            KeyCode::KEY_RIGHTCTRL => Ok(Key::RightControl),
            KeyCode::KEY_KPSLASH => Ok(Key::NumpadDivide),
            KeyCode::KEY_RIGHTALT => Ok(Key::RightAlt),
            KeyCode::KEY_HOME => Ok(Key::Home),
            KeyCode::KEY_UP => Ok(Key::UpArrow),
            KeyCode::KEY_PAGEUP => Ok(Key::PageUp),
            KeyCode::KEY_LEFT => Ok(Key::LeftArrow),
            KeyCode::KEY_RIGHT => Ok(Key::RightArrow),
            KeyCode::KEY_END => Ok(Key::End),
            KeyCode::KEY_DOWN => Ok(Key::DownArrow),
            KeyCode::KEY_PAGEDOWN => Ok(Key::PageDown),
            KeyCode::KEY_INSERT => Ok(Key::Insert),
            KeyCode::KEY_DELETE => Ok(Key::ForwardDelete),
            KeyCode::KEY_MUTE => Ok(Key::Mute),
            KeyCode::KEY_VOLUMEDOWN => Ok(Key::VolumeDown),
            KeyCode::KEY_VOLUMEUP => Ok(Key::VolumeUp),
            KeyCode::KEY_KPEQUAL => Ok(Key::NumpadEquals),
            KeyCode::KEY_KPPLUSMINUS => Ok(Key::NumpadMinus),
            KeyCode::KEY_LEFTMETA => Ok(Key::Meta),
            KeyCode::KEY_RIGHTMETA => Ok(Key::RightMeta),
            value => bail!("No such key code: {value}"),
        }
    }

    #[cfg(target_os = "windows")]
    pub fn convert(&self) -> Result<Key> {
        match self {
            KeyCode::KEY_ESC => {Ok(Key::Escape)},
            KeyCode::KEY_1 => {Ok(Key::Num1)},
            KeyCode::KEY_2 => {Ok(Key::Num2)},
            KeyCode::KEY_3 => {Ok(Key::Num3)},
            KeyCode::KEY_4 => {Ok(Key::Num4)},
            KeyCode::KEY_5 => {Ok(Key::Num5)},
            KeyCode::KEY_6 => {Ok(Key::Num6)},
            KeyCode::KEY_7 => {Ok(Key::Num7)},
            KeyCode::KEY_8 => {Ok(Key::Num8)},
            KeyCode::KEY_9 => {Ok(Key::Num9)},
            KeyCode::KEY_10 => {Ok(Key::Num0)},
            KeyCode::KEY_MINUS => {Ok(Key::OEMMinus)},
            KeyCode::KEY_EQUAL => {Ok(Key::OEMNECEqual)},
            KeyCode::KEY_BACKSPACE => {Ok(Key::Backspace)},
            KeyCode::KEY_TAB => {Ok(Key::Tab)},
            KeyCode::KEY_Q => {Ok(Key::Q)},
            KeyCode::KEY_W => {Ok(Key::W)},
            KeyCode::KEY_E => {Ok(Key::E)},
            KeyCode::KEY_R => {Ok(Key::R)},
            KeyCode::KEY_T => {Ok(Key::T)},
            KeyCode::KEY_Y => {Ok(Key::Y)},
            KeyCode::KEY_U => {Ok(Key::U)},
            KeyCode::KEY_I => {Ok(Key::I)},
            KeyCode::KEY_O => {Ok(Key::O)},
            KeyCode::KEY_P => {Ok(Key::P)},
            KeyCode::KEY_LEFTBRACE => {Ok(Key::Unicode('['))},
            KeyCode::KEY_RIGHTBRACE => {Ok(Key::Unicode(']'))},
            KeyCode::KEY_ENTER => {Ok(Key::Return)},
            KeyCode::KEY_LEFTCTRL => {Ok(Key::LControl)},
            KeyCode::KEY_A => {Ok(Key::A)},
            KeyCode::KEY_S => {Ok(Key::S)},
            KeyCode::KEY_D => {Ok(Key::D)},
            KeyCode::KEY_F => {Ok(Key::F)},
            KeyCode::KEY_G => {Ok(Key::G)},
            KeyCode::KEY_H => {Ok(Key::H)},
            KeyCode::KEY_J => {Ok(Key::J)},
            KeyCode::KEY_K => {Ok(Key::K)},
            KeyCode::KEY_L => {Ok(Key::L)},
            KeyCode::KEY_SEMICOLON => {Ok(Key::Unicode(';'))},
            KeyCode::KEY_APOSTROPHE => {Ok(Key::Unicode('\''))},
            KeyCode::KEY_GRAVE => {Ok(Key::Unicode('`'))},
            KeyCode::KEY_LEFTSHIFT => {Ok(Key::LShift)},
            KeyCode::KEY_BACKSLASH => {Ok(Key::Unicode('\\'))},
            KeyCode::KEY_Z => {Ok(Key::Z)},
            KeyCode::KEY_X => {Ok(Key::X)},
            KeyCode::KEY_C => {Ok(Key::C)},
            KeyCode::KEY_V => {Ok(Key::V)},
            KeyCode::KEY_B => {Ok(Key::B)},
            KeyCode::KEY_N => {Ok(Key::N)},
            KeyCode::KEY_M => {Ok(Key::M)},
            KeyCode::KEY_COMMA => {Ok(Key::OEMComma)},
            KeyCode::KEY_DOT => {Ok(Key::OEMPeriod)},
            KeyCode::KEY_SLASH => {Ok(Key::Unicode('/'))},
            KeyCode::KEY_RIGHTSHIFT => {Ok(Key::RShift)},
            KeyCode::KEY_LEFTALT => {Ok(Key::Alt)},
            KeyCode::KEY_SPACE => {Ok(Key::Space)},
            KeyCode::KEY_CAPSLOCK => {Ok(Key::CapsLock)},
            KeyCode::KEY_F1 => {Ok(Key::F1)},
            KeyCode::KEY_F2 => {Ok(Key::F2)},
            KeyCode::KEY_F3 => {Ok(Key::F3)},
            KeyCode::KEY_F4 => {Ok(Key::F4)},
            KeyCode::KEY_F5 => {Ok(Key::F5)},
            KeyCode::KEY_F6 => {Ok(Key::F6)},
            KeyCode::KEY_F7 => {Ok(Key::F7)},
            KeyCode::KEY_F8 => {Ok(Key::F8)},
            KeyCode::KEY_F9 => {Ok(Key::F9)},
            KeyCode::KEY_F10 => {Ok(Key::F10)},
            KeyCode::KEY_NUMLOCK => {Ok(Key::Numlock)},
            KeyCode::KEY_KP7 => {Ok(Key::Numpad7)},
            KeyCode::KEY_KP8 => {Ok(Key::Numpad8)},
            KeyCode::KEY_KP9 => {Ok(Key::Numpad9)},
            KeyCode::KEY_KPMINUS => {Ok(Key::OEMMinus)},
            KeyCode::KEY_KP4 => {Ok(Key::Numpad4)},
            KeyCode::KEY_KP5 => {Ok(Key::Numpad5)},
            KeyCode::KEY_KP6 => {Ok(Key::Numpad6)},
            KeyCode::KEY_KPPLUS => {Ok(Key::OEMPlus)},
            KeyCode::KEY_KP1 => {Ok(Key::Numpad1)},
            KeyCode::KEY_KP2 => {Ok(Key::Numpad2)},
            KeyCode::KEY_KP3 => {Ok(Key::Numpad3)},
            KeyCode::KEY_KP0 => {Ok(Key::Numpad0)},
            // KeyCode::KEY_KPDOT => {Ok(Key::)},
            KeyCode::KEY_F11 => {Ok(Key::F11)},
            KeyCode::KEY_F12 => {Ok(Key::F12)},
            KeyCode::KEY_RIGHTCTRL => {Ok(Key::RControl)},
            KeyCode::KEY_UP => {Ok(Key::UpArrow)},
            KeyCode::KEY_PAGEUP => {Ok(Key::PageUp)},
            KeyCode::KEY_LEFT => {Ok(Key::LeftArrow)},
            KeyCode::KEY_RIGHT => {Ok(Key::RightArrow)},
            KeyCode::KEY_END => {Ok(Key::End)},
            KeyCode::KEY_DOWN => {Ok(Key::DownArrow)},
            KeyCode::KEY_PAGEDOWN => {Ok(Key::PageDown)},
            KeyCode::KEY_INSERT => {Ok(Key::Insert)},
            KeyCode::KEY_DELETE => {Ok(Key::Delete)},
            KeyCode::KEY_LEFTMETA => {Ok(Key::LWin)},
            KeyCode::KEY_RIGHTMETA => {Ok(Key::RWin)},
            value => bail!("No such key code: {value}"),
        }
    }
}